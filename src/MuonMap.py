#!/usr/bin/env python
# -*- coding: utf-8 -*-
import numpy as np


class MuonMap:
    def __init__(self):
        self.dData = np.fromstring("""
 1.323609e+02  1.187303e+02  9.395542e+01  6.895397e+01  4.840035e+01
 3.251341e+01  2.091493e+01  1.282508e+01  7.433439e+00  4.007066e+00
 1.945498e+00  7.860169e-01  1.895583e-01 -7.845296e-02 -1.691854e-01
-1.726411e-01 -1.390602e-01 -9.562383e-02 -5.631717e-02 -2.703336e-02
-8.487988e-03  1.335395e-03  5.137142e-03  5.495047e-03  4.413872e-03
 3.072145e-03  1.835842e-03  6.221296e-04 -6.599210e-04 -1.829552e-03
-2.470651e-03 -2.467011e-03 -1.996112e-03 -1.483970e-03 -1.217739e-03
-1.242982e-03 -1.399658e-03 -1.550564e-03 -1.492873e-03 -1.091996e-03
-4.217213e-04  3.443991e-04  1.022913e-03  1.490880e-03  1.786550e-03
 2.054111e-03  2.299077e-03  2.372312e-03  2.122376e-03  1.491762e-03
 5.303430e-04 -4.858504e-04 -1.286566e-03 -1.638024e-03 -1.536687e-03
-1.157604e-03 -8.427614e-04 -9.519352e-04 -1.534490e-03 -2.439957e-03
-3.454757e-03 -4.376512e-03 -4.991014e-03 -5.234057e-03
""", dtype=float, sep=" ")

        self.nData = np.fromstring("7.29968 0.934955 -0.819887",
                                   dtype=float, sep=" ")

        fData = np.fromstring("""
-5.67131 0.00697119 0.0826894 -0.35593 0.0474401 -0.00116869 -0.0194853 0.0307934 -0.0111455 0.00191349 0.00417879 -1.35947 0.0263883 -0.063497 -0.24545 0.0172541 -0.0339713 -0.0228878 0.10761 -0.0124089 -0.00867379 -0.00670516 0.633313 -0.160635 -0.0420799 0.283346 0.402295 -0.223792 -0.217999 0.12973 0.473869 -0.0855633 0.0792657 -0.511347 -0.983409 0.570433 0.208227 1.7346 -0.485487 -0.986803 -0.220425 1.93974 -0.290391 0.529204 -2.79273 -1.49705 0.931425 0.191393 2.18954 -0.389784 -1.43124 -0.603929 2.57691 -0.387088 0.818804 -2.3374 -0.698919 0.480975 0.145751 0.889938 -0.0899556 -0.663381 -0.332941 1.11669 -0.171718 0.380108
-0.0116664 -0.0318911 0.00180778 -0.00316171 -0.00369295 0.0068894 -0.00401539 0.00480608 -0.00608479 -0.00957082 0.00305386 -0.0183516 -0.0708764 -0.0261259 -0.00541173 -0.00391184 -0.0489495 -0.017969 0.0177144 -0.0206021 -0.106013 0.00185376 0.00206695 0.0106913 -0.00220241 0.176348 0.14017 -0.33098 0.163388 -0.177083 0.126755 0.103123 -0.0972496 0.0457897 0.24264 0.295608 0.783923 0.612233 -0.833719 0.669803 -0.801171 0.631321 1.51637 -0.352824 0.0500601 0.23456 0.541921 1.11333 0.859709 -0.977231 0.793054 -1.04681 0.877385 2.50928 -0.422774 0.0111477 0.0412504 0.273932 0.514973 0.390403 -0.422004 0.298312 -0.436414 0.39082 1.19962 -0.165575
0.0178961 0.00592405 0.00454438 -0.0411616 0.00387561 0.00103059 -0.00635128 -0.00966875 0.0167205 -0.00058578 -0.0048294 -0.0711542 -0.0712455 0.0202739 -0.220004 0.094358 0.0827443 -0.0668348 -0.0132177 0.0594656 -0.0488431 -0.0829637 -0.0712728 -0.0817044 -0.112325 0.32918 0.258134 0.178044 0.239629 0.349804 0.0568547 -0.0915638 -0.02692 0.73214 0.751809 -0.519254 2.73236 -0.00205383 -0.137128 1.53873 1.15301 0.0704175 0.033645 0.667437 1.39774 1.60418 -0.641227 3.94813 -0.504512 -0.492577 2.20721 1.25283 0.184146 0.158689 1.1524 0.685119 0.858971 -0.246669 1.73002 -0.342308 -0.255428 0.972056 0.453846 0.132426 0.0824267 0.536757
0.394491 -0.000794024 -0.0213368 0.169406 -0.018353 1.46942e-05 0.00800527 -0.0261539 0.00487118 0.00502057 -0.000113339 0.441771 -0.0318785 0.114977 0.109741 0.0471928 0.0427173 0.0546426 -0.0786299 -0.0461857 0.0219667 -0.0494369 -0.356168 0.164911 0.00938923 -0.328223 -0.47497 0.281205 0.109835 0.10095 -0.519615 -0.0131106 -0.0167035 -1.06503 0.928402 -1.24444 -0.514734 -2.56067 0.763693 0.013923 0.922347 -1.59396 -0.26903 0.458999 -1.42579 1.24152 -2.2922 -0.398839 -3.56496 0.877531 -0.126066 1.43936 -1.93413 -0.512039 0.832816 -0.78367 0.506929 -1.22276 -0.176242 -1.54772 0.352563 -0.084195 0.686594 -0.815363 -0.276651 0.416319
-0.00771939 0.0258816 9.92052e-05 -0.0101696 -0.0255889 -0.011999 -0.00589324 -0.00523794 0.0020002 0.00504988 -0.00450514 0.00267458 0.0660312 0.033863 -0.0451214 -0.039429 -0.00775664 -0.0519309 -0.0448528 0.00139683 0.0399591 -0.0303338 0.303755 -0.228869 0.135001 0.242904 0.224678 -0.092983 0.0973772 0.182472 0.12017 -0.00195042 0.250061 0.878991 -1.09861 0.361697 1.31628 0.872583 -0.624814 0.93173 1.13602 0.519211 -0.376726 1.2111 0.896951 -1.47048 0.501098 1.87986 1.04865 -0.936022 1.50508 1.6526 0.722638 -0.64602 1.66193 0.310193 -0.589184 0.238128 0.848387 0.412467 -0.419593 0.728825 0.736931 0.322124 -0.30131 0.726482
0.00122276 0.0309578 -0.000364965 -0.00106763 0.00105425 0.00310239 0.00834881 -0.00601706 0.00996875 0.00994852 0.00234251 0.0135162 0.0787166 0.0038244 0.0176543 0.0270043 0.0726045 0.0840637 -0.0334413 0.0623431 0.0948085 0.00256553 -0.0406609 0.0759896 -0.212702 -0.176312 -0.148033 0.175358 -0.0854218 0.225245 -0.154331 -0.17204 -0.129458 -0.280771 0.175575 -0.764562 -1.06838 -0.844571 -0.0617759 -1.25551 1.08293 -0.984199 -1.56257 -0.609638 -0.423277 0.288355 -0.858374 -1.66143 -1.19769 -0.419827 -2.13413 1.39765 -1.32475 -2.41161 -0.917912 -0.199205 0.139684 -0.31023 -0.796349 -0.529082 -0.25373 -1.04785 0.564851 -0.547946 -1.11231 -0.442968
0.0109855 0.00121626 0.000813604 0.0188629 0.000535485 0.00120382 0.00599374 -0.00277126 7.5099e-05 0.00313139 0.00182877 0.0198139 0.0806715 0.00423386 0.0253499 -0.00949019 -0.00405429 0.0372433 -0.0326191 0.0273118 0.0521496 0.0532458 -0.0865076 -0.0359528 -0.247707 -0.180967 -0.0583223 -0.0754184 -0.195658 -0.103527 -0.175821 -0.121676 0.136709 -0.118601 -0.911186 -1.12871 -0.49409 -0.152188 -0.128754 -1.03956 -0.0946347 -0.845912 -0.92589 -0.350275 0.124299 -1.46391 -1.55272 -0.408356 -0.20516 0.00422233 -1.45515 0.0331786 -1.08544 -1.33043 -1.09055 0.150361 -0.671329 -0.673744 -0.0978711 -0.104857 0.0673944 -0.646538 0.054421 -0.444914 -0.576732 -0.668163
-0.051759 -0.000274698 -0.000752865 0.00468384 0.000172027 0.000369754 0.000633688 -0.00112104 0.000798485 0.000262528 -0.000146981 0.00681075 -0.00267125 0.00634259 -0.00744279 0.00563775 0.00300104 0.00119918 -0.00774578 0.00531378 -0.000307156 -4.4353e-05 -0.0706731 0.0115735 -5.68133e-05 -0.02817 -0.0502202 0.00654013 0.0321239 -0.016713 -0.0517441 0.00164647 -0.0151163 -0.121048 0.0850408 -0.0490977 -0.0274238 -0.237853 0.00228493 0.130629 0.00424425 -0.26174 0.0235902 -0.0746547 -0.109732 0.134341 -0.0864271 -0.00868905 -0.320968 -0.00703991 0.178792 0.0365542 -0.370771 0.0443431 -0.110198 -0.0158736 0.0636318 -0.0455087 0.00362462 -0.139713 -0.00569205 0.0803026 0.0223059 -0.166233 0.0233294 -0.0509447
0.000552666 0.00327447 -5.4717e-05 0.000465998 0.000470566 -0.00104273 0.000514456 -0.000643353 0.000469708 0.000900045 -0.000162196 0.00145459 0.00513996 0.00276819 0.00135333 4.98629e-05 0.00274202 0.00277909 -0.00205671 0.000775195 0.010118 0.000577788 0.00337188 -0.00214369 -0.00598807 -0.0208631 -0.0143679 0.0396351 -0.0158199 0.0252464 -0.0161185 -0.00237197 0.0060709 0.00953065 -0.0085099 -0.0539467 -0.0941681 -0.0590143 0.127509 -0.0756709 0.111193 -0.0647193 -0.116774 0.0184305 0.0140073 0.00953481 -0.0861183 -0.13128 -0.0825444 0.162172 -0.0965216 0.146559 -0.0840324 -0.20445 0.0218722 0.00721491 0.0138764 -0.0412704 -0.0595797 -0.0377487 0.0709638 -0.0387887 0.062273 -0.0359675 -0.0998342 0.00874708
0.000567588 -0.000292375 -0.000792042 0.00597672 -0.000629955 -0.000163723 0.000220878 0.00020655 -0.00194474 4.47696e-05 0.000248927 0.0171547 0.00923138 -0.00267794 0.0262988 -0.00945906 -0.00955835 0.00361258 -0.00480454 -0.00717996 -0.000625601 0.00566119 0.00155275 0.0137488 0.0122028 -0.0584831 -0.0164999 -0.0118253 -0.0272917 -0.0339273 0.0193094 -0.00688318 0.00171662 -0.148418 -0.0650304 0.0540075 -0.384061 0.0322013 0.0525798 -0.147837 -0.0633211 0.10084 -0.00718065 -0.0469355 -0.250496 -0.148124 0.0635969 -0.538164 0.0894425 0.108104 -0.209145 -0.0412467 0.126047 0.00631253 -0.0800071 -0.117276 -0.0798581 0.0231266 -0.233895 0.0504324 0.0529419 -0.092414 -0.00671723 0.0497219 0.00745777 -0.0366884
0.0200464 -5.51947e-05 -0.00258914 0.00350246 -0.00148997 -0.000440515 0.000149069 0.00134079 -0.000511918 -0.000852338 -0.00023789 0.0290888 0.00350824 -0.00956597 0.00946836 -0.0100585 -0.00557022 -0.00339791 0.00572895 -0.000101681 0.000163265 0.00586928 0.0430485 -0.0156605 -0.00311743 0.0320563 0.0576351 -0.0101354 -0.0243546 -0.015739 0.0627284 0.00368146 0.0113862 0.0757388 -0.0996865 0.0864028 0.0569407 0.317265 0.000464138 -0.0602531 -0.0994708 0.250597 0.00263014 -0.0127683 0.0696645 -0.142324 0.173515 0.0466123 0.448936 0.0129558 -0.062471 -0.141874 0.331746 0.00214786 -0.0378181 0.0303395 -0.0617844 0.0951788 0.0186991 0.198481 0.0075792 -0.022366 -0.0639645 0.144462 0.00225488 -0.0205568
0.000688836 -0.00208061 0.00014722 0.000767975 0.000258666 0.000648398 0.00094405 0.000661478 5.61364e-05 -0.000332055 0.000427873 0.000124658 -0.00952652 -0.00161952 0.00405101 -0.00145655 -0.000972294 0.00656706 0.00508661 -0.00068529 -0.00203168 0.00263416 -0.0275507 0.0229091 -0.0170451 -0.025375 -0.0169395 0.0195866 -0.0226294 -0.0199336 -0.0151915 0.0028898 -0.0241287 -0.0859475 0.150426 -0.062999 -0.136309 -0.0471222 0.108208 -0.146977 -0.125285 -0.0545958 0.0293837 -0.112364 -0.093189 0.213818 -0.0880715 -0.195506 -0.0483419 0.153545 -0.217725 -0.182806 -0.0713017 0.0450859 -0.151284 -0.0341484 0.0887023 -0.0401956 -0.0885439 -0.0160873 0.0678183 -0.100292 -0.0817666 -0.0309675 0.019732 -0.0651498
-7.19735e-05 -0.00399205 -0.00014934 0.000124532 9.71764e-06 -1.67174e-05 -0.000936648 0.000707174 -0.00064279 -0.0010269 -0.000216415 -0.000536545 -0.00733818 -0.00163709 -0.00158341 -0.00205863 -0.00518564 -0.00948312 0.00423112 -0.00474892 -0.0106702 -0.000233968 0.00383722 -0.00916903 0.0289939 0.0147164 0.0123371 -0.0237355 0.0123189 -0.0283609 0.00912391 0.0182172 0.0120528 0.0176285 -0.0541327 0.120688 0.0910422 0.0713058 -0.031682 0.145244 -0.143235 0.0674395 0.174392 0.0561521 0.0239033 -0.0926623 0.150946 0.142026 0.102835 -0.00987883 0.237514 -0.193549 0.0923464 0.271846 0.0838486 0.0108895 -0.0442665 0.0608871 0.0680924 0.0461786 0.00335394 0.113906 -0.0822083 0.0381272 0.12604 0.0402174
-0.0019185 -9.88496e-05 -8.35278e-05 -0.00275042 6.28291e-06 -0.000324095 -0.000461863 0.0007437 -3.9389e-05 -0.000400637 -0.000199156 -0.00341251 -0.00895295 0.000996634 -0.00213238 0.000145412 0.000664527 -0.00161768 0.00611656 -0.00357604 -0.00318627 -0.00462458 0.0211057 -0.0016359 0.0290849 0.0276624 0.0107423 0.0100576 0.0265844 0.00255018 0.0119046 0.019382 -0.00839097 0.0558654 0.0831619 0.111684 0.0563979 0.0455327 0.0152808 0.114749 -0.0422241 0.069862 0.100344 0.045813 0.0366198 0.143126 0.144614 0.0286643 0.0644429 -0.00204538 0.153635 -0.0781209 0.0914527 0.136312 0.117824 0.00305748 0.0675155 0.0606893 -0.00128608 0.0299193 -0.00877785 0.0669934 -0.0389639 0.0371187 0.058352 0.0694181
0.000326804 4.42715e-06 1.30192e-06 -6.82071e-05 -7.07897e-06 -7.47742e-06 -6.45557e-06 2.20813e-05 -1.05843e-05 -9.23106e-06 2.94923e-06 1.86187e-05 3.31114e-05 -0.000129766 7.37523e-05 -6.1818e-05 -3.99104e-05 -5.96583e-05 0.000263139 -9.28301e-05 2.0835e-05 -2.42814e-05 0.00166203 -0.000225664 -0.000194112 0.00073061 0.00107551 -0.000119637 -0.000935759 0.000677834 0.00100678 0.000108323 0.000320251 0.00550058 -0.00147201 0.000413771 0.00122725 0.00451921 -0.000405855 -0.00351759 0.000319032 0.00511422 -0.000223008 0.00200655 0.0071412 -0.00231698 0.000941496 0.000842037 0.00587715 -0.000605836 -0.00472765 -0.00052712 0.00730978 -0.000768301 0.00316446 0.00286273 -0.00110518 0.00048061 0.000192827 0.00250334 -0.000285168 -0.00210736 -0.000411488 0.00330544 -0.000477405 0.00151468
-1.0022e-05 3.4998e-05 -1.09114e-05 -1.46228e-05 -1.31826e-05 2.9842e-05 -1.66479e-05 1.98282e-05 -1.11106e-05 -2.54087e-05 1.38538e-06 -3.41531e-05 0.000109502 -0.000112803 -5.45834e-05 8.70506e-06 -2.47622e-05 -9.40143e-05 4.52425e-05 6.5224e-07 -0.000291532 -3.56207e-05 -0.000134967 0.000402988 0.00022218 0.000600271 0.000453592 -0.00121563 0.000457314 -0.000788678 0.000559077 -0.000125194 -5.08442e-06 -0.000431581 -0.000516929 0.00209485 0.00275528 0.00166079 -0.00443998 0.00225789 -0.00322321 0.00207744 0.00257928 0.00034173 -0.000608138 -0.00294233 0.00345995 0.00375605 0.00209728 -0.00573586 0.00283715 -0.00409107 0.0026926 0.00482269 0.000653001 -0.000296008 -0.00223011 0.00171591 0.00165036 0.000844334 -0.00244629 0.00109665 -0.00167788 0.00118257 0.00238889 0.000358851
-0.000164748 1.00373e-05 3.40801e-05 -0.000218792 2.84704e-05 9.53081e-06 8.5105e-07 3.10753e-06 6.08607e-05 -4.0524e-06 -6.79343e-07 -0.000759813 -0.000229171 7.9608e-05 -0.00093883 0.000296662 0.000316512 -8.452e-05 0.000241336 0.000223428 0.000115371 -0.000141672 0.000199091 -0.000589051 -0.000653366 0.0020998 0.000100901 0.000133098 0.000528988 0.00121263 -0.0010458 0.000409102 -0.000232118 0.00645263 0.000632911 -0.00282613 0.0135916 -0.0025185 -0.00272388 0.00322709 0.00197665 -0.00497605 -0.000144363 0.000609567 0.0106841 0.00237003 -0.00371655 0.0189527 -0.00470894 -0.00487266 0.0047018 0.00118302 -0.0064021 -0.00122989 0.00144009 0.0051155 0.001406 -0.00160976 0.00819658 -0.00238733 -0.00232458 0.00208775 0.000188972 -0.00264294 -0.000807408 0.000746318
-0.000228587 4.25576e-06 4.79395e-05 -5.28754e-05 2.73709e-05 1.41515e-05 -1.76385e-06 -4.20655e-05 6.47468e-06 2.48071e-05 2.7588e-06 -0.000618658 -2.53376e-05 0.000237445 -0.00020262 0.000184718 0.000136208 0.000111238 -0.00019592 -6.0188e-05 -3.6986e-05 -0.000142189 -0.00146042 0.000367494 0.000349296 -0.00108608 -0.00125315 0.000245479 0.000646069 0.000461346 -0.00132532 -0.00019377 -0.000193523 -0.00415028 0.00173101 -0.00120348 -0.00314796 -0.00649764 0.000109338 0.00119067 0.00329746 -0.00486006 3.53231e-05 0.000630522 -0.00586317 0.00220691 -0.00350037 -0.00366863 -0.00905717 -4.47108e-05 0.000865039 0.00486359 -0.00634333 0.000350123 0.00136623 -0.00284533 0.00086198 -0.00226576 -0.00153834 -0.00397864 -3.00781e-05 0.000185653 0.00222552 -0.00276261 0.000184292 0.000711296
-1.77871e-05 6.65429e-05 -8.41916e-06 -2.32492e-05 -1.25912e-05 -4.56013e-06 -3.29775e-05 -2.16311e-05 -2.55493e-06 6.90122e-06 -1.30845e-05 -3.84649e-06 0.000478012 -1.26037e-06 -0.000129803 6.05491e-05 8.65134e-05 -0.000208056 -0.00015971 3.87314e-05 1.21952e-05 -6.94036e-05 0.000731253 -0.000458911 0.000582713 0.000764755 0.000456574 -0.000881712 0.000915407 0.000686855 0.000579648 -0.000199505 0.000733232 0.00232357 -0.00542136 0.00253143 0.00424902 0.000909732 -0.00465503 0.00529501 0.00413412 0.00191618 -0.000845406 0.00326985 0.00256082 -0.00815361 0.00355105 0.00617786 0.000634379 -0.00649884 0.00760934 0.00595851 0.00239933 -0.00108427 0.00430924 0.000952696 -0.00344908 0.00159115 0.0028215 9.43055e-05 -0.00286038 0.00344542 0.00264578 0.00101603 -0.000424883 0.00182267
-7.8484e-07 0.000124615 9.17342e-06 -5.12652e-06 -1.5326e-07 -8.35594e-06 3.17752e-05 -1.94579e-05 1.3425e-05 3.32688e-05 5.76602e-06 -1.01164e-05 0.00014412 8.60513e-05 3.76724e-05 5.74904e-05 8.36202e-05 0.000315912 -0.000113302 9.43246e-05 0.000345152 1.00906e-05 -0.000100677 0.000309158 -0.000937524 -0.000394126 -0.000352636 0.000798896 -0.000504388 0.000771632 -0.000214786 -0.000549315 -0.000395988 -0.000239996 0.00284529 -0.0042894 -0.00240344 -0.00207278 0.00175851 -0.00501579 0.00391751 -0.00141339 -0.00543669 -0.00185333 -0.00025074 0.00480655 -0.00560674 -0.0037312 -0.0030491 0.00143576 -0.00792069 0.00534217 -0.00184629 -0.00848486 -0.00273173 -0.000110275 0.00224936 -0.00233917 -0.00178152 -0.00139756 0.000381097 -0.00371434 0.00229242 -0.000725647 -0.00393192 -0.00129175
8.59849e-05 1.0342e-06 -5.04737e-06 0.000104835 -4.09905e-06 9.44658e-06 9.99139e-06 -3.23393e-05 1.26173e-06 1.67149e-05 4.35783e-06 0.000155147 0.0002417 -4.257e-05 0.000104834 -7.0032e-06 -3.91129e-05 1.96598e-05 -0.000245949 0.000105206 7.03315e-05 0.000120288 -0.000729942 0.000102983 -0.000721279 -0.000892544 -0.00033066 -0.000289019 -0.000803913 8.16733e-05 -0.000213239 -0.000705214 0.000236926 -0.00210271 -0.00207847 -0.00269539 -0.00170265 -0.00145021 -0.000189831 -0.00327569 0.00228159 -0.00148601 -0.00315799 -0.00119318 -0.00154546 -0.0036982 -0.0034771 -0.000571742 -0.0020651 0.000526749 -0.00432629 0.00375644 -0.00190578 -0.0041448 -0.00317284 -0.000230874 -0.0017661 -0.00145471 0.000260767 -0.000954568 0.000494548 -0.0018726 0.00178058 -0.000735474 -0.00175266 -0.00190061
-2.48422e-06 -2.14896e-08 -9.62942e-08 8.94301e-07 -4.76984e-08 2.40091e-08 2.57011e-08 -1.89319e-07 7.55371e-09 6.77031e-08 -3.31199e-08 1.73068e-06 -5.01178e-08 8.64033e-07 1.2647e-06 -3.44847e-07 -1.38411e-07 5.75423e-07 -2.37744e-06 1.62614e-07 -4.37863e-07 5.06839e-07 -1.03978e-05 9.35992e-07 3.83115e-06 -5.77257e-06 -6.32083e-06 1.33798e-06 8.29502e-06 -7.19097e-06 -5.06483e-06 -1.30755e-06 -9.89106e-07 -3.70403e-05 5.57546e-06 7.34214e-06 -2.17455e-05 -1.9542e-05 1.03294e-05 2.97889e-05 -7.51898e-06 -2.45628e-05 3.54861e-06 -1.31358e-05 -4.0135e-05 9.08127e-06 8.24164e-06 -2.73885e-05 -2.15463e-05 1.7146e-05 3.87224e-05 -1.57877e-06 -3.59086e-05 1.05116e-05 -2.28545e-05 -1.01101e-05 4.51967e-06 3.71597e-06 -1.17891e-05 -8.02479e-06 8.32487e-06 1.67186e-05 9.65952e-07 -1.67168e-05 6.29486e-06 -1.13336e-05
6.07077e-08 -1.10695e-06 1.63116e-07 1.30699e-07 8.44067e-08 -2.23239e-07 1.53378e-07 -1.59057e-07 9.18686e-08 1.9547e-07 1.73464e-08 2.39381e-07 -4.38064e-06 1.29844e-06 6.31595e-07 -1.96792e-07 -2.32792e-07 9.83798e-07 -1.94139e-07 -1.70657e-07 2.46168e-06 4.65614e-07 1.48289e-06 -1.01298e-05 -1.49196e-06 -5.01736e-06 -4.30047e-06 1.11397e-05 -4.06535e-06 6.70689e-06 -5.58844e-06 2.23796e-06 -1.32652e-06 5.32401e-06 1.26737e-05 -1.99899e-05 -2.43592e-05 -1.37859e-05 4.44814e-05 -2.12217e-05 2.53545e-05 -1.95827e-05 -1.72781e-05 -9.68192e-06 7.58096e-06 5.9063e-05 -3.48214e-05 -3.32468e-05 -1.50202e-05 5.7111e-05 -2.66445e-05 3.10044e-05 -2.5309e-05 -3.46115e-05 -1.51654e-05 3.64673e-06 4.13385e-05 -1.77645e-05 -1.44528e-05 -4.92585e-06 2.35957e-05 -1.01141e-05 1.23113e-05 -1.12701e-05 -1.73431e-05 -7.45573e-06
1.56183e-06 -1.06283e-07 -2.98986e-07 2.04308e-06 -2.90955e-07 -1.30223e-07 -4.56091e-08 -2.05348e-08 -5.67668e-07 5.16333e-08 -3.37652e-08 7.84154e-06 1.57551e-06 -4.36188e-07 9.40282e-06 -2.75171e-06 -3.05839e-06 7.44087e-07 -2.53981e-06 -2.09392e-06 -1.57935e-06 1.26092e-06 -1.99902e-06 5.76518e-06 8.05869e-06 -2.03753e-05 1.24737e-06 8.03505e-07 -2.07876e-06 -1.35511e-05 1.21532e-05 -4.25291e-06 4.35874e-06 -7.31103e-05 1.47625e-06 3.27935e-05 -0.000134905 3.17007e-05 3.43116e-05 -1.88574e-05 -2.50768e-05 5.67235e-05 5.50515e-06 2.39319e-06 -0.000126885 -9.46218e-06 4.35333e-05 -0.00018739 5.43905e-05 5.76446e-05 -2.8972e-05 -1.96276e-05 7.40086e-05 1.96938e-05 -3.93571e-06 -6.32863e-05 -6.97445e-06 1.92427e-05 -8.02872e-05 2.66944e-05 2.7129e-05 -1.28899e-05 -5.721e-06 3.11018e-05 1.17113e-05 -3.35364e-06
1.33276e-06 -7.98213e-08 -3.22287e-07 3.51121e-07 -1.48557e-07 -1.05055e-07 3.7759e-08 2.73313e-07 5.40593e-08 -2.1225e-07 -2.4561e-11 3.84974e-06 -3.14902e-07 -1.77289e-06 7.0227e-07 -6.90851e-07 -9.94313e-07 -1.02618e-06 1.70363e-06 1.19463e-06 5.39914e-07 9.61202e-07 1.31442e-05 -1.92295e-06 -4.87578e-06 1.22498e-05 7.23166e-06 -2.59178e-06 -5.28283e-06 -3.56204e-06 7.45856e-06 1.89356e-06 -1.77201e-07 5.22944e-05 -4.45794e-06 3.28981e-06 4.68457e-05 3.35157e-05 -4.65959e-06 -7.02235e-06 -2.91189e-05 2.11932e-05 -2.15269e-06 -1.01614e-05 7.86404e-05 -2.57849e-06 2.37523e-05 5.95713e-05 4.54258e-05 -5.40122e-06 -1.7574e-06 -4.44075e-05 2.58951e-05 -6.87398e-06 -1.73829e-05 3.74642e-05 3.61837e-07 1.82754e-05 2.54095e-05 1.9679e-05 -2.4751e-06 1.25927e-06 -2.07013e-05 1.11209e-05 -3.61308e-06 -8.61013e-06
1.39651e-07 -9.82835e-07 1.18661e-07 2.10914e-07 1.24812e-07 -5.74411e-08 3.04967e-07 2.06964e-07 3.45539e-08 -4.65188e-08 1.26673e-07 3.19751e-08 -7.36408e-06 3.96867e-07 1.29348e-06 -6.64202e-07 -1.09474e-06 1.85272e-06 1.46817e-06 -4.93992e-07 1.96909e-07 5.9866e-07 -5.77434e-06 -6.82951e-07 -5.22503e-06 -6.98416e-06 -4.37095e-06 1.12069e-05 -9.41545e-06 -6.81133e-06 -6.09173e-06 2.61826e-06 -6.78673e-06 -1.84281e-05 5.07595e-05 -2.50728e-05 -4.03529e-05 -7.17138e-06 5.61749e-05 -5.18478e-05 -3.94488e-05 -1.87937e-05 7.79102e-06 -2.94234e-05 -2.0365e-05 8.02796e-05 -3.51514e-05 -5.93891e-05 -3.08596e-06 7.77709e-05 -7.38047e-05 -5.60498e-05 -2.24716e-05 8.55637e-06 -3.80481e-05 -7.58656e-06 3.37092e-05 -1.55318e-05 -2.73085e-05 6.53313e-07 3.43115e-05 -3.33076e-05 -2.46233e-05 -9.17204e-06 2.95873e-06 -1.58001e-05
2.9696e-08 -1.397e-06 -7.75684e-08 4.57617e-08 -2.64803e-08 1.70856e-07 -3.2215e-07 1.45454e-07 -9.31284e-08 -2.89719e-07 -6.13053e-08 2.78411e-07 -2.37173e-07 -1.00352e-06 -2.73458e-07 -5.32878e-07 -1.87122e-07 -3.09208e-06 8.29067e-07 -4.97338e-07 -3.11248e-06 -2.3641e-07 4.91133e-07 -3.52841e-06 8.33295e-06 3.39751e-06 3.36309e-06 -8.13589e-06 5.76719e-06 -5.68892e-06 1.95771e-06 4.84186e-06 3.75981e-06 -9.78755e-07 -3.81032e-05 4.08662e-05 1.98496e-05 1.98019e-05 -2.27121e-05 5.07715e-05 -2.8979e-05 9.78103e-06 4.82701e-05 1.88127e-05 -2.30371e-06 -6.1986e-05 5.47718e-05 3.03567e-05 2.98078e-05 -2.24032e-05 7.79554e-05 -3.97242e-05 1.1622e-05 7.51686e-05 2.78408e-05 -1.01381e-06 -2.86102e-05 2.32428e-05 1.4341e-05 1.40279e-05 -7.44067e-06 3.58838e-05 -1.71393e-05 4.15746e-06 3.47624e-05 1.30882e-05
-3.42039e-07 -7.40474e-10 2.63947e-08 -9.16121e-07 4.56241e-08 -7.4441e-08 -7.64905e-08 2.9684e-07 4.01653e-09 -1.80364e-07 -2.35329e-08 -5.56612e-07 -1.90242e-06 3.0893e-07 -7.94733e-07 6.04063e-08 4.64333e-07 -9.24062e-08 2.34161e-06 -7.78573e-07 -5.15796e-07 -9.70708e-07 7.88924e-06 -1.1088e-06 4.90604e-06 7.91205e-06 2.7296e-06 2.40522e-06 6.91939e-06 -1.85871e-06 1.11851e-06 6.9298e-06 -2.43285e-06 2.02753e-05 1.56705e-05 1.84149e-05 1.29233e-05 1.20346e-05 -1.56023e-07 2.77465e-05 -2.57473e-05 8.55621e-06 2.90223e-05 8.26028e-06 1.4176e-05 2.85779e-05 2.33802e-05 7.52202e-07 1.70617e-05 -7.72031e-06 3.65073e-05 -4.06725e-05 9.99787e-06 3.73662e-05 2.46917e-05 1.88761e-06 1.37661e-05 9.45604e-06 -4.62347e-06 7.83972e-06 -5.87739e-06 1.57538e-05 -1.89375e-05 3.29601e-06 1.56712e-05 1.53319e-05
""", dtype=float, sep=" ")

        self.fData = np.zeros((4, 4, 2, 6, 6, 2))
        self.local = np.zeros((6, 6, 2))

        i = 0
        for ind, x in np.ndenumerate(self.fData):
            if (ind[1] == 0 and ind[2] == 1) or (ind[4] == 0 and ind[5] == 1):
                continue
            self.fData[ind] = fData[i]
            i += 1

    def D(self, theta):
        n = len(self.dData)
        z = 2 * theta / (0.5 * np.pi) - 1.0
        d = 0.0
        dd = 0.0
        for i in range(n - 1, 0, -1):
            sv = d
            d = 2 * z * d - dd + self.dData[i]
            dd = sv
        return z * d + 0.5 * self.dData[0] - dd

    def TotalMuonNumber(self, theta):
        lgD = np.log10(self.D(theta))
        return 10 ** (self.nData[0] + self.nData[1] + self.nData[2] * lgD)

    def SetThetaPhi(self, theta, phi):
        self.nmu = self.TotalMuonNumber(theta)

        dmax = self.D(np.radians(90))
        dmin = self.D(0)

        z = 2 * (self.D(theta) - dmin) / (dmax - dmin) - 1

        self.local *= 0

        for ind, x in np.ndenumerate(self.fData):
            if (ind[1] == 0 and ind[2] == 1) or (ind[4] == 0 and ind[5] == 1):
                continue
            if ind[5] == 0:
                self.local[ind[:3]] += x * z ** ind[3] * np.cos(ind[4] * phi)
            else:
                self.local[ind[:3]] += x * z ** ind[3] * np.sin(ind[4] * phi)

    def __call__(self, r, zeta):
        sqr = np.sqrt(r)
        result = 0.0
        for ind, z in np.ndenumerate(self.local):
            if ind[1] == 0 and ind[2] == 1:
                continue
            if ind[2] == 0:
                result += z * sqr ** ind[0] * np.cos(ind[1] * zeta)
            else:
                result += z * sqr ** ind[0] * np.sin(ind[1] * zeta)
        return 10 ** (result + np.log10(self.nmu))
